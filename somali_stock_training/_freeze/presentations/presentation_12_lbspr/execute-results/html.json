{
  "hash": "b1576ea74f58d08756fa74153755d3f3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to Length-Based Models\"\nsubtitle: \"Somali Fish Stock Training\"\ndate: today\n\nauthor: \n    - name: \"Masumbuko Semba\"\n      affiliation: \"Nelson Mandela African Institution of Science and Technology\"\n      email: \"lugosemba@gmail.com\"\n    - name: \"Rushingisha George\"\n      affiliation: \"Tanzania Fisheries Research Institute\"\n      email: \"george.rushingisha@tafiri.go.tz\"\n    - name: \"Mathew Silas\"\n      affiliation: \"Deep Sea Fishing Authority\"\n      email: \"mathewsilas28@gmail.com\"\nformat: revealjs\ntheme: 'simple'\ntransition: slide\nbackground-transition: fade\nhighlight-style: github\nslide-number: true\nembed-resources: true\nexecute:\n  eval: false\n  echo: true\n  warning: false\ncode-fold: show\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n# Welcome to Length-Based Approach  {background-color=\"#447099\"}\nStock Assessment Models\n\n## Introduction to Length-Based Stock Assessment Models {.scrollable}\n\n::::: columns\n::: {.column width=\"50%\"}\n### Learning Objectives\n\n-   <i class=\"fa-solid fa-lightbulb\"></i> Understand why length-based models are used in data-limited fisheries.\n-   <i class=\"fa-solid fa-keyboard\"></i> Learn the key inputs for the LBSPR model.\n-   <i class=\"fa-brands fa-r-project\"></i> Run a basic LBSPR analysis in R.\n-   <i class=\"fa-solid fa-chart-line\"></i> Interpret the main outputs: SPR and F/M.\n:::\n\n::: {.column width=\"50%\"}\n### Why This Matters\n\n-   <i class=\"fa-solid fa-tools\"></i> These are the most practical and powerful tools for your data.\n-   <i class=\"fa-solid fa-chart-bar\"></i> Provides a quantitative estimate of stock status.\n-   <i class=\"fa-solid fa-bullhorn\"></i> Directly informs management about fishing pressure.\n:::\n:::::\n\n------------------------------------------------------------------------\n\n\n## What is a \"Fish Stock\"?   {.scrollable}\n\nBefore we model, we must understand what we are assessing.\n\n\n<div style=\"position: relative; max-width: 600px; margin: 2rem auto; padding: 2rem; font-family: Georgia, serif; font-size: 1.5rem; line-height: 1.6; color: #333; text-align: center;\">\n  <span style=\"font-family: 'Times New Roman', serif; font-size: 14rem; color: #17280b; position: absolute; top: 0; left: 10px; line-height: 1; opacity: 0.7;\">‚Äú</span>\n  <p style=\"font-style: italic; font-family: Poppins;font-size: 2.5rem; color:#3e880a; margin: 0; padding: 0 4rem;\">A group of fish of the same species that live in a particular geographic area and mix enough to share a common gene pool</p>\n  <span style=\"font-family: 'Times New Roman', serif; font-size: 15rem; color: #17280b; position: absolute; bottom: -20px; right: 10px; line-height: 0; opacity: 0.7;\">‚Äù</span>\n</div>\n\n- Understanding the stock is the first step. The model's results apply only to the stock we define.\n\n\n<!-- ## Key Assumptions  {.scrollable}\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n#### üåç Geographic Isolation\nThe population is self-contained. We assume fish don't move in or out from other areas in large numbers.\n\n#### üé£ Fishing is the Driver\nChanges in the stock (like mortality) are driven by natural causes and our fishing, not migration.\n:::\n::: {.column width=\"50%\"}\n::: {.callout-tip appearance=\"simple\"}\n### Our Stock for this Session\n> \"For this session, we will assess the **\"Tuna\"** group caught in Somali waters as a single stock.\"\n:::\n:::\n:::: -->\n\n\n## Critical Assumptions {.scrollable}\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n### 1. Stock Boundaries\n\n**Scientific Basis:** The assessed population represents a self-sustaining unit with minimal immigration or emigration.\n\n**Practical Implication:** Fish movement between regions must be negligible relative to population size.\n\n### 2. Fishing as Primary Driver\n\n**Scientific Basis:** Population dynamics are driven by natural mortality and fishing mortality, not by migration patterns.\n\n**Practical Implication:** Changes in stock size reflect fishing pressure, not population shifts.\n:::\n\n::: {.column width=\"50%\"}\n### 3. Representative Sampling\n\n**Scientific Basis:** Length distributions in catches accurately represent the population structure.\n\n**Practical Implication:** Sampling must be unbiased and cover the full spatial and temporal range of the fishery.\n\n::: {.callout-tip}\n## For This Training\nWe will assess **yellowfin tuna** caught in Somali waters as a discrete stock, recognizing this is a simplification that may require refinement for formal assessments.\n:::\n:::\n::::\n\n\n<!-- # Length-Based Models  {background-color=\"#447099\"}\n## Why Length-Based Models?  {.scrollable}\n\n- In many fisheries, we lack age data, which is difficult and expensive to collect.\n- Length-based models use the **size structure** of the catch to infer the status of the stock.\n\n::: {.callout-warning appearance=\"simple\"}\n### A Core Assumption\n> The distribution of lengths in our **catch** reflects the distribution of lengths in the **ocean**.\n::: -->\n\n\n\n# Length-Based Assessment Methods {background-color=\"#447099\"}\n\n## Why Use Length-Based Models? {.scrollable}\n\n### The Challenge of Data-Limited Fisheries\n\nMany developing-nation fisheries lack:\n\n- Age-reading laboratories and trained personnel\n- Long-term catch and effort time series\n- Comprehensive biological sampling programs\n- Resources for expensive aging techniques (otolith reading)\n\n### The Solution: Length-Based Analysis\n\n**Advantages:**\n\n- Length data is relatively easy and inexpensive to collect\n- Measurements can be taken dockside without specialized equipment\n- Large sample sizes are feasible with minimal resources\n- Well-established theoretical foundation\n\n::: {.callout-important}\n## Core Assumption\nThe length distribution in your **catch sample** must reflect the length distribution in the **exploited population**. Biased sampling (e.g., only large fish, one gear type) will compromise results.\n:::\n\n------------------------------------------------------------------------\n\n<!-- ## Introducing LBSPR  {.scrollable}\n\n**LBSPR: Length-Based Spawning Potential Ratio**\n\n**What it does**: LBSPR estimates the **Spawning Potential Ratio (SPR)** of a stock.\n\n**SPR**: The proportion of the *unfished* reproductive potential that is remaining in the *current, fished* population.\n\n-   **SPR ‚âà 1.0 (or 100%)**: Unfished stock, maximum reproductive output.\n-   **SPR = 0.4 (or 40%)**: A common management target. The stock has 40% of its original reproductive capacity.\n-   **SPR \\< 0.2 (or 20%)**: A common limit or threshold. The stock is likely overfished. -->\n\n\n## What is LBSPR Model Framework {.scrollable}\n\n**Length-Based Spawning Potential Ratio** is a stock assessment model that estimates reproductive capacity under current fishing pressure.\n\n- Developed by Hordyk et al. (2015)\n- Based on equilibrium life history theory\n- Uses size-structured population dynamics\n- Validated across multiple species and fisheries\n\n## LBSPR Model Framework Model Outputs\n\n**Primary Metric: SPR (Spawning Potential Ratio)**\n\n- Proportion of unfished reproductive potential remaining\n- Values range from 0 (collapsed) to 1 (unfished)\n- Directly comparable to management reference points\n\n\n## Interpreting SPR Values\n\n| SPR Range | Stock Status | Management Implication |\n|-----------|--------------|------------------------|\n| > 0.40 | Healthy | Current fishing sustainable |\n| 0.20 - 0.40 | Moderately exploited | Monitor closely, consider precautionary measures |\n| < 0.20 | Overfished | Urgent management action required |\n\n\n## Reference Points\n\n- **Target:** SPR = 40% (widely used globally)\n- **Limit:** SPR = 20% (conservation threshold)\n- These values may be adjusted based on species-specific characteristics and management objectives\n\n------------------------------------------------------------------------\n\n## Key Inputs for LBSPR  {.scrollable}\n\nTo run LBSPR, we need two main things:\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n1.  **üìä Length Frequency Data**: A representative sample of the lengths of fish caught from the stock.\n\n2.  **üß¨ Life History Parameters**:\n\n    -   `Linf`: Asymptotic length (the theoretical maximum size).\n    -   `MK`: The ratio of natural mortality (M) to the growth rate (K).\n    -   `L50`: Length at 50% maturity.\n    -   `L95`: Length at 95% maturity.\n:::\n\n::: {.column width=\"50%\"}\nThese parameters can often be found on [**FishBase.org**](https://www.fishbase.se/search.php) for your species or a similar one.\n\n![](fishbase.png)\n:::\n::::\n\n\n\n\n\n\n## Parameters needed - 1  Biology\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n- von Bertalanffy asymptotic length (Linf)\n- M/K ratio (natural mortality divided by von Bertalanffy K coefficient) (MK)\n- Length at 50% maturity (L50)\n- Length at 95% maturity (L95)\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMyPars@Linf <- 100 \nMyPars@L50 <- 66 \nMyPars@L95 <- 70\nMyPars@MK <- 1.5 \n```\n:::\n\n\n\n:::\n::::\n\n\n\n## Parameters needed - 2  Exploitation\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n- Length at 50% selectivity (SL50) \n- Length at 95% selectivity (SL95) \n- F/M ratio (FM) or SPR (SPR). \n\n> If you specify both, the F/M value will be ignored.\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMyPars@SL50 <- 50 \nMyPars@SL95 <- 65\nMyPars@SPR <- 0.4\n```\n:::\n\n\n\n:::\n::::\n\n\n## Parameters needed - 3 Size Classes\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n- Width of the length classes (BinWidth)\n- Maximum length of the sample (BinMax) \n- Minimum length of sample (BinMin)\n- Units for the length parameters\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMyPars@BinWidth <- 5\nMyPars@BinMax <- 150\nMyPars@BinMin <- 0\n\nMyPars@L_units <- \"mm\"\n```\n:::\n\n\n\n:::\n::::\n\n## Interpreting LBSPR Output\n\nThe model provides three key estimates:\n\n1.  **SPR (Spawning Potential Ratio)**:\n    -   The plot shows an estimated SPR.\n    -   It inform on the state of the stock.\n    -   A common target is 40% and a limit is 20%. \n2.  **F/M (Fishing Mortality / Natural Mortality)**:\n    -   The estimated F/M ratio.\n    -   It tells us how intense fishing mortality is relative to natural death.\n    -   An F/M ratio \\> 1.0 suggests that fishing is causing more deaths than natural causes, a sign of high fishing pressure.\n3.  **The fish state-stock**:\n\n------------------------------------------------------------------------\n\n## Key Takeaways\n\n-   Length-based models like **LBSPR** are powerful tools for assessing data-limited stocks.\n-   They require **length frequency data** and some basic **life history parameters**.\n-   The key outputs, **SPR** and **F/M**, provide a quantitative snapshot of stock status and fishing pressure.\n-   These results can directly inform management actions, such as deciding whether to increase, decrease, or maintain current fishing effort.\n\n------------------------------------------------------------------------\n\n## Questions & Discussion\n\n**Thank You**\n\n\n\n\n# Demonstration  {background-color=\"#447099\"}\n\nWe will use yellofin tuna as modal. Its information can be sourced from [fishbase page](https://www.fishbase.se/summary/thunnus-albacares.html)\n\n## Step 1: Prepare the Length Data {.scrollable}\n\nFirst, we need to process our raw data into the format LBSPR requires: a simple vector of fish lengths. We will filter for our target species group, \"Tuna\", and remove any invalid length measurements.\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for Tuna and select the length column\ntuna_lengths <- lw |> \n  filter(\n    fish_group == \"Tuna\",\n    !is.na(length_cm)\n  ) |> \n  pull(length_cm)\n\n# How many fish do we have?\n\ntuna_lengths |> \nlength()\n\n# Let's look at the first few lengths\ntuna_lengths |> \nhead()\n\ntuna_lengths |> \n  range()\n```\n:::\n\n\n\n:::\n::: {.column width=\"50%\"}\n\nIt's always a good idea to visualize your length data with a histogram before running the model. This helps you spot any potential issues with the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(tuna_lengths, \n     main = \"Length Frequency of Tuna\",\n     xlab = \"Length (cm)\",\n     breaks = 30)\n```\n:::\n\n\n\n:::\n::::\n\n\n## Step 1 : Create LBSPR Objects\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMyPars <- new(\"LB_pars\")\n```\n:::\n\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n- The LB_pars object has 25 slots. \n- Not all parameters need to be specified for the simulation model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMyPars |> slotNames()\n```\n:::\n\n\n\n:::\n::::\n\n## Step 2: Populate\n\nNow, we populate the `LB_pars` object with key metric \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Biological\n# MyPars$Species = \"Yellowfin\"\nMyPars@Linf <- 100 \nMyPars@L50 <- 66 \nMyPars@L95 <- 70\nMyPars@MK <- 1.5 \n\n# Exploitation\n\nMyPars@SL50 <- 50 \nMyPars@SL95 <- 65\nMyPars@SPR <- 0.4\n\n# Size Classes\n\nMyPars@BinWidth <- 5\nMyPars@BinMax <- 150\nMyPars@BinMin <- 0\nMyPars@L_units <- \"mm\"\n```\n:::\n\n\n\n\n## Step 3: Run the LBSPR Model\n\nWith our parameters and lengths objects ready, we can now run the `LBSPRfit` function. This is the core of the analysis, where the model fits the parameters to the length data to estimate the stock status.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the LBSPR model\nlbspr_fit <- MyPars |> \n  LBSPR::LBSPRsim()\n```\n:::\n\n\n\nThe `lbspr_fit` object now contains all the results of our analysis.\n\n\n## Step 4: View and Plot the Results\n\nThe model provides estimates for selectivity (`SL50`, `SL95`), fishing pressure (`F/M`), and most importantly, the stock status (`SPR`).\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\nYou can view the key estimated parameters directly from the fitted object.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlbspr_fit@Ests\n```\n:::\n\n\n\n:::\n::: {.column width=\"50%\"}\nThe `plotSim` function gives a comprehensive visual summary of the fit\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlbspr_fit |> \nplotSim()\n```\n:::\n\n\n\n:::\n::::\n\n\n## Interpreting the Real Output\n\nLet's look at the plot from our `lbspr_fit` object.\n\n!{fig-align=\"center\" width=\"80%\"}\n\n1.  **Left Panel**: Shows the fit of the model (red line) to your observed length data (grey bars). A good fit means the line follows the general shape of the bars.\n2.  **Right Panel**: This is the key result. It shows the estimated **SPR** (Spawning Potential Ratio). The black dot is the estimate, and the grey area is the uncertainty. You can compare this value directly to your management targets (e.g., 40%) and limits (e.g., 20%).\n\nBased on this output, you can make a clear statement about the stock's status.\n\n---\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}