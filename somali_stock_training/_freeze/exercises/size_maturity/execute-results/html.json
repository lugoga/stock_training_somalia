{
  "hash": "67957e941083f9d62a25d6d85ad5cb30",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Determination Size at Maturity\"\nsubtitle: \"Selected species of tuna and tuna-like fish in Somalia Water\"\nauthor: \"Rushingisha George, Masumbuko Semba, and Mathew Silas\"\nformat: html\ndate: \"2025-12-16\"\ndate-modified: today\ntoc: true\nlot: true\nlof: true\nembed-resources: true\nexecute: \n  echo: true\n  error: false\n  comment: \"\"\n  warning: false\n  message: false\n\ncode-fold: show\n\n---\n\n\n\n\n**What we're doing:** Load the R packages required for maturity analysis and data visualization.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(tidyverse)      # Data manipulation and visualization\nlibrary(sizeMat)        # For morphological maturity analysis\nlibrary(gt)             # For professional tables\nrequire(TropFishR)      # Tropical fisheries methods (if needed)\n```\n:::\n\n\n\n\n# Introduction\n\nThis document serves as a step-by-step exercise to determine the size at maturity (L50) for several commercially important fish species in Somalia. We will use a morphological method, which classifies fish as mature or immature based on their length-weight relationship.\n\nThe exercise will proceed as follows:\n\n1. Load and prepare the length-weight data.\n2. Explain the core functions from the `sizeMat` package.\n3. Apply the analysis to each fish species one by one.\n4. Combine the results into a summary plot and table for comparison.\n\n# Method\n\n## Data Preparation\n\n**What we're doing:** Load the fisheries dataset containing length and weight measurements for various fish species.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlw = read_csv(\"lw2.csv\")\n```\n:::\n\n\n\n\n### Identify Species with Sufficient Data\n\n**What we're doing:** Filter for fish species with at least 200 recorded individuals to ensure statistical reliability.\n\n**Why it matters:** Species with few observations produce unreliable estimates. Focusing on well-sampled species ensures robust maturity determinations.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfishes = lw |> \n  group_by(fish_type_code) |> \n  tally() |> \n  arrange(desc(n)) |> \n  filter(n > 200) |> \n  pull(fish_type_code)\n\n# Use these key tuna and mackerel species\nfishes = c(\"YFT\", \"SKJ\", \"KAW\", \"JAC\", \"LOT\", \"MAH\", \"SCH\", \"BET\")\n```\n:::\n\n\n\n\n### Create Species Reference Table\n\n**What we're doing:** Build a lookup table mapping FAO species codes to common and scientific names.\n\n**Why it matters:** Clear species identification ensures accurate communication and proper interpretation of results.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_name <- tibble(\n  FAO_Code = c(\"YFT\", \"SKJ\", \"KAW\", \"JAC\", \"LOT\", \"MAH\", \"SCH\", \"BET\"),\n  English_Name = c(\"Yellowfin tuna\", \"Skipjack tuna\", \"Kawakawa\", \"Jack mackerel\", \n                   \"Longtail tuna\", \"Mahi-mahi\", \"Chub mackerel\", \"Bigeye tuna\"),\n  Scientific_Name = c(\"Thunnus albacares\", \"Katsuwonus pelamis\", \"Euthynnus affinis\", \n                      \"Trachurus spp.\", \"Thunnus tonggol\", \"Coryphaena hippurus\", \n                      \"Scomber japonicus\", \"Thunnus obesus\")\n)\n\nfish_name\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 3\n  FAO_Code English_Name   Scientific_Name    \n  <chr>    <chr>          <chr>              \n1 YFT      Yellowfin tuna Thunnus albacares  \n2 SKJ      Skipjack tuna  Katsuwonus pelamis \n3 KAW      Kawakawa       Euthynnus affinis  \n4 JAC      Jack mackerel  Trachurus spp.     \n5 LOT      Longtail tuna  Thunnus tonggol    \n6 MAH      Mahi-mahi      Coryphaena hippurus\n7 SCH      Chub mackerel  Scomber japonicus  \n8 BET      Bigeye tuna    Thunnus obesus     \n```\n\n\n:::\n:::\n\n\n\n\n### Inspect Dataset Structure\n\n**What we're doing:** Display the column names and data types in the dataset.\n\n**What to look for:** Ensure date, length, weight, and species columns are present and correctly formatted.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlw |> \n    glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 3,571\nColumns: 19\n$ boat_id              <dbl> 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3…\n$ catch_id             <dbl> 1, 1, 1, 1, 1, 3, 7, 7, 7, 4, 4, 5, 5, 5, 9, 9, 9…\n$ fish_id              <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15…\n$ date_dd_mm_yy        <dttm> 2018-11-02, 2018-11-02, 2018-11-02, 2018-11-02, …\n$ year                 <dbl> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2…\n$ month                <chr> \"Nov\", \"Nov\", \"Nov\", \"Nov\", \"Nov\", \"Nov\", \"Nov\", …\n$ day                  <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…\n$ region               <chr> \"Mogadishu\", \"Mogadishu\", \"Mogadishu\", \"Mogadishu…\n$ landing_site         <chr> \"Lido Beach\", \"Lido Beach\", \"Lido Beach\", \"Lido B…\n$ vessel_id            <dbl> 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3…\n$ fish_type_code       <chr> \"YFT\", \"YFT\", \"YFT\", \"YFT\", \"YFT\", \"MAH\", \"OTH1\",…\n$ fish_index           <dbl> 1, 2, 3, 4, 5, 1, 1, 2, 3, 1, 2, 1, 2, 3, 1, 2, 3…\n$ weight_kg            <dbl> 7.7, 3.6, 4.5, 4.5, 3.2, 9.5, 2.3, 3.2, 2.3, 11.0…\n$ length_cm            <dbl> 76, 59, 65, 67, 61, 124, 55, 64, 55, 84, 85, 62, …\n$ fish_group           <chr> \"Tuna\", \"Tuna\", \"Tuna\", \"Tuna\", \"Tuna\", \"Other\", …\n$ notes                <chr> NA, NA, NA, NA, NA, NA, \"Aarjoog\", \"Aarjoog\", \"Aa…\n$ kobo_section_1_index <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kobo_section_2_index <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ kobo_section_3_index <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n```\n\n\n:::\n:::\n\n\n\n\n## Fish Groups Analysis\n\nIn the following sections, we will perform the size-at-maturity analysis for several key tuna and mackerel species. For each species, we:\n1. Filter the data to that species\n2. Classify fish as mature or immature using morphological criteria\n3. Model the maturity ogive to estimate L50 (length at 50% maturity)\n\n### Yellowfin Tuna\n\n**What we're doing:** Filter the dataset to create a subset containing only Yellowfin Tuna (YFT).\n\n**Why start here:** Yellowfin is a well-studied, commercially important species with good sample sizes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyft = lw |> \n    filter(fish_type_code == 'YFT')\n```\n:::\n\n\n\n\n### Maturity Classification using Linear Discriminant Analysis\n\n**What we're doing:** Use the `classify_mature()` function to separate fish into mature and immature groups based on their length-weight relationship.\n\n**How it works:**\n- Linear discriminant analysis (LDA) finds the boundary that best separates mature from immature fish in length-weight space\n- Creates a new `mature` column indicating classification for each fish\n- Works best when there's a clear separation between groups in the data\n\n**Why it matters:** This classification is the foundation for the subsequent ogive fitting and L50 estimation.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_yft <- yft |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),  # Variables to use for classification\n    varSex = NULL,                            # No sex data available\n    selectSex = NULL,\n    method = \"ld\"                             # Linear discriminant method\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_yft\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 384 \n\nNumber in adult group = 94 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -7.322622   0.461709  -15.86   <2e-16 ***\nx            0.197443   0.006518   30.29   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 2.400289)\n\n    Null deviance: 3119.30  on 383  degrees of freedom\nResidual deviance:  916.91  on 382  degrees of freedom\nAIC: 1430\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -65.60758    6.34616  -10.34   <2e-16 ***\nx             0.82557    0.05265   15.68   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 127.6477)\n\n    Null deviance: 43126  on 93  degrees of freedom\nResidual deviance: 11744  on 92  degrees of freedom\nAIC: 726.57\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate Std. Error    t value     Pr(>|t|)\n(Intercept)  -7.3226224 1.54018587  -4.754376 2.644698e-06\nx             0.1974434 0.02174360   9.080530 2.922047e-18\nmature      -58.2849588 3.28623457 -17.736092 2.346836e-54\nx:mature      0.6281301 0.03244821  19.357928 6.044495e-62\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n\n\n\n### Visualize Classification Results\n\n**What we're doing:** Plot the classified fish on a length-weight scatter plot to visually inspect classification quality.\n\n**What to look for:**\n- Clear spatial separation between mature (upper right) and immature (lower left) groups\n- Few misclassified points in the overlap region\n- Good coverage of the entire range\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_yft |> \n  plot(\n    main = 'Maturity Classification: Yellowfin Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n### Fit Maturity Ogive\n\n**What we're doing:** Model the maturity classification with a logistic regression curve using 1000 bootstrap samples.\n\n**What this produces:**\n- A smooth S-shaped (logistic) curve showing proportion mature at each length\n- Estimates of L50 (length at 50% maturity) and L95 (length at 95% maturity)\n- Bootstrap confidence intervals around these estimates\n\n**Why 1000 iterations:** Bootstrap resampling with 1000 iterations provides stable estimates and quantifies uncertainty in L50.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyft_ogive_fq <- classified_yft |> \n  morph_mature(\n    method = \"fq\",      # Frequentist method using logistic regression\n    niter = 1000        # 1000 bootstrap samples for stable estimates\n  )\n```\n:::\n\n\n\n\n### Plot Maturity Ogive\n\n**What we're doing:** Display the fitted maturity curve showing the proportion of mature fish at each length.\n\n**What it shows:**\n- X-axis: Length (cm)\n- Y-axis: Proportion of mature individuals (0 to 1)\n- S-shaped curve typical of logistic maturity schedules\n- L50 is where the curve crosses 0.5 (50% maturity)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyft_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Yellowfin Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 94.3 \nConfidence intervals = 92.4 - 96.5 \nRsquare = 0.89\n```\n\n\n:::\n:::\n\n\n\n\n### Bigeye Tuna\n\n**What we're doing:** Repeat the maturity analysis for Bigeye Tuna (BET).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbigeye = lw |> \n    filter(fish_type_code == 'BET')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_bet <- bigeye |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_bet\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 47 \n\nNumber in adult group = 54 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -6.89259    1.40281  -4.913 1.23e-05 ***\nx            0.18478    0.02499   7.395 2.66e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.535058)\n\n    Null deviance: 53.337  on 46  degrees of freedom\nResidual deviance: 24.078  on 45  degrees of freedom\nAIC: 107.94\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -6.66096    1.37579  -4.842 1.20e-05 ***\nx            0.17479    0.01749   9.991 1.07e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 2.378245)\n\n    Null deviance: 361.08  on 53  degrees of freedom\nResidual deviance: 123.67  on 52  degrees of freedom\nAIC: 203.99\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n                Estimate Std. Error     t value     Pr(>|t|)\n(Intercept) -6.892589006 2.36684783 -2.91213864 4.454437e-03\nx            0.184778291 0.04215873  4.38291908 2.968382e-05\nmature       0.231624336 2.61040596  0.08873115 9.294785e-01\nx:mature    -0.009988657 0.04442261 -0.22485527 8.225649e-01\n[1] \"slopes are the same\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_bet |> \n  plot(\n    main = 'Maturity Classification: Bigeye Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbet_ogive_fq <- morph_mature(\n    data = classified_bet, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbet_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Bigeye Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 62.5 \nConfidence intervals = 62.5 - 63 \nRsquare = 1\n```\n\n\n:::\n:::\n\n\n\n\n### Skipjack Tuna\n\n**What we're doing:** Analyze maturity for Skipjack Tuna (SKJ).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskj = lw |> \n    filter(fish_type_code == 'SKJ')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_skj <- skj |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_skj\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 177 \n\nNumber in adult group = 242 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept) 12.76290    4.21026   3.031   0.0028 **\nx           -0.07542    0.06164  -1.224   0.2227   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 57.13805)\n\n    Null deviance: 10084.7  on 176  degrees of freedom\nResidual deviance:  9999.2  on 175  degrees of freedom\nAIC: 1222.3\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.295127   0.450985  -0.654    0.513    \nx            0.061606   0.008485   7.261 5.33e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.313259)\n\n    Null deviance: 91.698  on 241  degrees of freedom\nResidual deviance: 75.182  on 240  degrees of freedom\nAIC: 409.86\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n                Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  12.76290452 2.74429465  4.650705 4.453582e-06\nx            -0.07542021 0.04017504 -1.877290 6.117953e-02\nmature      -13.05803195 4.82621335 -2.705647 7.098057e-03\nx:mature      0.13702593 0.08480911  1.615698 1.069195e-01\n[1] \"slopes are the same\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_skj |> \n  plot(\n    main = 'Maturity Classification: Skipjack Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskj_ogive_fq <- morph_mature(\n    data = classified_skj, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskj_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Skipjack Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 59.2 \nConfidence intervals = 58.4 - 60.2 \nRsquare = 0.74\n```\n\n\n:::\n:::\n\n\n\n\n### Kawakawa\n\n**What we're doing:** Analyze maturity for Kawakawa (KAW).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkaw = lw |> \n    filter(fish_type_code == 'KAW')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_kaw <- kaw |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_kaw\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 221 \n\nNumber in adult group = 88 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 19.52081    2.25452   8.659 1.05e-15 ***\nx           -0.26208    0.03768  -6.955 4.01e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 12.82692)\n\n    Null deviance: 3429.6  on 220  degrees of freedom\nResidual deviance: 2809.1  on 219  degrees of freedom\nAIC: 1195.1\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept) 0.943610   0.316189   2.984  0.00370 **\nx           0.019815   0.006459   3.068  0.00289 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.162647)\n\n    Null deviance: 15.518  on 87  degrees of freedom\nResidual deviance: 13.988  on 86  degrees of freedom\nAIC: 93.887\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  19.5208105 1.91515989 10.192784 3.452735e-21\nx            -0.2620805 0.03200910 -8.187688 7.353140e-15\nmature      -18.5772002 3.05896897 -6.073027 3.729322e-09\nx:mature      0.2818955 0.05830129  4.835150 2.113165e-06\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_kaw |> \n  plot(\n    main = 'Maturity Classification: Kawakawa',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkaw_ogive_fq <- morph_mature(\n    data = classified_kaw, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkaw_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Kawakawa',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 52.1 \nConfidence intervals = 50.4 - 53.1 \nRsquare = 0.61\n```\n\n\n:::\n:::\n\n\n\n\n### Jack Mackerel\n\n**What we're doing:** Analyze maturity for Jack Mackerel (JAC).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njac = lw |> \n    filter(fish_type_code == 'JAC')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_jac <- jac |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_jac\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 153 \n\nNumber in adult group = 136 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1.182173   0.190937  -6.191 5.37e-09 ***\nx            0.067762   0.003261  20.778  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.2652843)\n\n    Null deviance: 154.583  on 152  degrees of freedom\nResidual deviance:  40.058  on 151  degrees of freedom\nAIC: 235.16\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -9.17278    1.39456  -6.578 9.84e-10 ***\nx            0.20412    0.01765  11.566  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 5.237425)\n\n    Null deviance: 1402.45  on 135  degrees of freedom\nResidual deviance:  701.81  on 134  degrees of freedom\nAIC: 615.13\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) -1.18217347 0.59810330 -1.976537 4.905786e-02\nx            0.06776167 0.01021588  6.632976 1.649592e-10\nmature      -7.99061056 1.15078904 -6.943593 2.587095e-11\nx:mature     0.13635474 0.01609834  8.470111 1.322469e-15\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_jac |> \n  plot(\n    main = 'Maturity Classification: Jack Mackerel',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\njac_ogive_fq <- morph_mature(\n    data = classified_jac, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\njac_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Jack Mackerel',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 69.1 \nConfidence intervals = 67 - 70.8 \nRsquare = 0.6\n```\n\n\n:::\n:::\n\n\n\n\n### Longtail Tuna\n\n**What we're doing:** Analyze maturity for Longtail Tuna (LOT).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlot = lw |> \n    filter(fish_type_code == 'LOT')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_lot <- lot |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_lot\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 167 \n\nNumber in adult group = 119 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.036814   0.435406  -4.678    6e-06 ***\nx            0.089616   0.006362  14.087   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.445462)\n\n    Null deviance: 161.896  on 166  degrees of freedom\nResidual deviance:  73.501  on 165  degrees of freedom\nAIC: 342.87\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -6.67824    1.21192   -5.51 2.16e-07 ***\nx            0.16794    0.01429   11.76  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 1.98903)\n\n    Null deviance: 507.56  on 118  degrees of freedom\nResidual deviance: 232.72  on 117  degrees of freedom\nAIC: 423.52\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate  Std. Error   t value     Pr(>|t|)\n(Intercept) -2.03681376 0.679798367 -2.996203 2.976712e-03\nx            0.08961564 0.009932577  9.022395 2.926832e-17\nmature      -4.64142846 1.124263924 -4.128415 4.815380e-05\nx:mature     0.07832407 0.014494373  5.403757 1.389924e-07\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_lot |> \n  plot(\n    main = 'Maturity Classification: Longtail Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlot_ogive_fq <- morph_mature(\n    data = classified_lot, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlot_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Longtail Tuna',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 77.6 \nConfidence intervals = 76.4 - 78.7 \nRsquare = 0.7\n```\n\n\n:::\n:::\n\n\n\n\n### Mahi-mahi\n\n**What we're doing:** Analyze maturity for Mahi-mahi (MAH).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmah = lw |> \n    filter(fish_type_code == 'MAH')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_mah <- mah |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_mah\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 65 \n\nNumber in adult group = 192 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 45.43976    5.64328   8.052 2.89e-11 ***\nx           -0.29975    0.05052  -5.933 1.38e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 49.80705)\n\n    Null deviance: 4891.1  on 64  degrees of freedom\nResidual deviance: 3137.8  on 63  degrees of freedom\nAIC: 442.46\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.631788   0.528260  -1.196    0.233    \nx            0.065457   0.006148  10.647   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 1.039763)\n\n    Null deviance: 315.41  on 191  degrees of freedom\nResidual deviance: 197.55  on 190  degrees of freedom\nAIC: 556.35\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  45.4397593 2.90335517  15.65078 4.501646e-39\nx            -0.2997497 0.02599251 -11.53215 5.259435e-25\nmature      -46.0715471 3.45944011 -13.31763 5.071576e-31\nx:mature      0.3652065 0.03398368  10.74653 1.951909e-22\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_mah |> \n  plot(\n    main = 'Maturity Classification: Mahi-mahi',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmah_ogive_fq <- morph_mature(\n    data = classified_mah, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmah_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Mahi-mahi',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 105.1 \nConfidence intervals = 102.8 - 108.8 \nRsquare = 0.6\n```\n\n\n:::\n:::\n\n\n\n\n### Chub Mackerel\n\n**What we're doing:** Analyze maturity for Chub Mackerel (SCH).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsch = lw |> \n    filter(fish_type_code == 'SCH')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Partitioning with Linear Discriminant Analysis\nclassified_sch <- sch |> \n  classify_mature(\n    varNames = c(\"length_cm\", \"weight_kg\"),\n    varSex = NULL, \n    selectSex = NULL,\n    method = \"ld\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n```{.r .cell-code}\nclassified_sch\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber in juvenile group = 178 \n\nNumber in adult group = 49 \n\n-------------------------------------------------------- \n1) Linear regression for juveniles \n\nCall:\nglm(formula = y ~ x, data = juv)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.264379   0.396674   0.666    0.506    \nx           0.026073   0.004938   5.280 3.78e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.2914736)\n\n    Null deviance: 59.424  on 177  degrees of freedom\nResidual deviance: 51.299  on 176  degrees of freedom\nAIC: 289.69\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n2) Linear regression for adults \n\nCall:\nglm(formula = y ~ x, data = adt)\n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -10.555467   0.831908  -12.69   <2e-16 ***\nx             0.176104   0.008501   20.71   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 1.578051)\n\n    Null deviance: 751.300  on 48  degrees of freedom\nResidual deviance:  74.168  on 47  degrees of freedom\nAIC: 165.37\n\nNumber of Fisher Scoring iterations: 2\n\n-------------------------------------------------------- \n3) Difference between slopes (ANCOVA) \n               Estimate  Std. Error    t value     Pr(>|t|)\n(Intercept)   0.2643791 0.551121681   0.479711 6.319031e-01\nx             0.0260733 0.006861272   3.800067 1.866385e-04\nmature      -10.8198461 0.741946828 -14.583048 2.827909e-34\nx:mature      0.1500305 0.008534969  17.578327 5.507599e-44\n[1] \"slopes are different\"\n```\n\n\n:::\n:::\n\n\n\n\n**What we're doing:** Visualize the classification results for Chub Mackerel.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclassified_sch |> \n  plot(\n    main = 'Maturity Classification: Chub Mackerel',\n    xlab = 'Length (cm)', \n    ylab = 'Weight (kg)',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1\n  )\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsch_ogive_fq <- morph_mature(\n    data = classified_sch, \n    method = \"fq\", \n    niter = 1000\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsch_ogive_fq |> \n    plot(\n    main = 'Maturity Ogive: Chub Mackerel',\n    xlab = 'Length (cm)', \n    ylab = 'Proportion Mature',\n    cex.main = 1.5,\n    cex.lab = 1.2,\n    cex.axis = 1, \n    onlyOgive = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](size_maturity_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 93.9 \nConfidence intervals = 91.3 - 97.7 \nRsquare = 0.37\n```\n\n\n:::\n:::\n\n\n\n\n# Combined Maturity Ogives\n\n**What we're doing:** Automate the entire analysis for all species and create a multi-panel figure for easy visual comparison of maturity schedules across species.\n\n**The loop:**\n\n- Iterates through all eight species\n- Classifies each using LDA\n- Fits maturity ogives with bootstrap resampling\n- Extracts L50, L95, and other parameters\n- Creates an 8-panel figure showing all ogives together\n\n**Why combine them:** Side-by-side comparison reveals differences in maturity schedules between species, which is important for species-specific management strategies.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 4))\n\nogive = list()\nlf_tb = list()\n\nfor (i in 1:length(fishes)){\n\n    classified = lw |> \n      ## select species\n      filter(fish_type_code == fish_name$FAO_Code[i]) |> \n      # classify using linear discriminant analysis\n      classify_mature(\n        varNames = c(\"length_cm\", \"weight_kg\"),\n        varSex = NULL, \n        selectSex = NULL,\n        method = \"ld\"\n      ) \n      \n    # fit maturity ogive with 1000 bootstrap samples\n    morph = classified |>  \n      morph_mature(\n        method = \"fq\", \n        niter = 1000\n    )\n\n    ogive[[i]] = morph\n\n    # Extract and store L50 and other parameters\n    lf_tb[[i]] = morph |> \n        print() |> \n        as.data.frame() |> \n        as_tibble() |> \n        mutate(Freq = as.numeric(Freq)) |> \n        pivot_wider(names_from = Var1 , values_from  = Freq) |> \n        mutate(\n          species = fish_name$English_Name[i], \n          scientific = fish_name$Scientific_Name[i]\n          ) |> \n        slice(1)\n\n    # Plot maturity ogive for this species\n    morph |> \n        plot(\n        main = paste(fish_name$English_Name[i], sep = \" \"),\n        xlab = 'Length (cm)', \n        ylab = 'Proportion Mature',\n        cex.main = 1.5,\n        cex.lab = 1.2,\n        cex.axis = 1, \n        onlyOgive = TRUE\n    )\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nall individuals were used in the analysis \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 94.3 \nConfidence intervals = 92.4 - 96.5 \nRsquare = 0.89all individuals were used in the analysis \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 59.2 \nConfidence intervals = 58.4 - 60.2 \nRsquare = 0.74all individuals were used in the analysis \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 52.1 \nConfidence intervals = 50.4 - 53.1 \nRsquare = 0.61all individuals were used in the analysis \n\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 69.1 \nConfidence intervals = 67 - 70.8 \nRsquare = 0.6all individuals were used in the analysis \n\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 77.6 \nConfidence intervals = 76.4 - 78.7 \nRsquare = 0.7all individuals were used in the analysis \n\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 105.1 \nConfidence intervals = 102.8 - 108.8 \nRsquare = 0.6all individuals were used in the analysis \n\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 93.9 \nConfidence intervals = 91.3 - 97.7 \nRsquare = 0.37all individuals were used in the analysis \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nformula: Y = 1/1+exp-(A + B*X) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSize at morphometric maturity = 62.5 \nConfidence intervals = 62.5 - 63 \nRsquare = 1\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Maturity ogives for eight commercially important fish species from Somalian waters. Each panel displays the logistic regression curve representing the proportion of mature individuals as a function of their length (cm). The maturity classification was determined using a morphological approach based on length-weight data.](size_maturity_files/figure-html/fig-ogive-1.png){#fig-ogive width=672}\n:::\n:::\n\n\n\n\n# Summary Table of Results\n\n**What we're doing:** Compile all L50 estimates and ogive parameters into a comprehensive table for easy reference and comparison.\n\n**Table columns:**\n- **Species & Scientific name:** Fish identification\n- **A & B:** Logistic curve parameters (intercept and slope)\n- **L50:** Length (cm) at 50% maturity—key reference point for management\n- **R²:** Goodness of fit (closer to 1.0 is better)\n\n\n#| label: tbl-ogive\n#| tbl-cap: \"Summary of the morphological size-at-maturity analysis for selected fish species. The table displays the estimated parameters from the logistic regression model: intercept (A), slope (B), length at 50% maturity (L50), and the coefficient of determination (R²).\"\n\nlf_tb |> bind_rows() |> \n  dplyr::select(-1) |> \n  relocate(c(species, scientific), .before = A) |> \n  gt() |> \n    fmt_number(columns = everything(), decimals = 2) |> \n    fmt_missing(columns = everything(), missing_text = '-') |> \n    cols_label(\n        species ~ 'Fish Type',\n        scientific ~ 'Scientific Name',\n        L50 ~ md('L~50~ (cm)'),\n        R2 ~ md('R^2^')\n    ) |>\n    tab_spanner(columns = c('A', 'B'), label = 'Ogive Parameters') |> \n    tab_options(data_row.padding = px(5), table.font.size = '10pt') |> \n    cols_width(\n        species ~ px(160),\n        scientific ~ px(180),\n        A ~ px(120),\n        B ~ px(70),\n        L50 ~ px(70),\n        R2 ~ px(70)\n    ) |> \n    tab_footnote(footnote = 'A = intercept of the logistic curve; B = slope of the logistic curve', \n                 locations = cells_column_labels(columns = c('A', 'B')))\n",
    "supporting": [
      "size_maturity_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}